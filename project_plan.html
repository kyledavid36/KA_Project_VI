<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project Plan - Project VI</title>
  <meta name="description" content="Live project plan and milestones for Project VI Group 4." />
  <meta name="robots" content="noindex, nofollow" />
  <meta name="author" content="Alan Hosseinpour" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link rel="stylesheet" href="css/site_style.css" />
  <style>
    /* Basic styling for the commit history section */
    .commit-item {
      border: 1px solid #444; /* Darker border to match */
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      background-color: #24292e; /* The requested dark grey background */
      color: #e6edf3;           /* A light text color for readability */
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .commit-item p {
      margin: 5px 0;
      line-height: 1.5;
    }
    .commit-item strong {
      color: #fff; /* Make bold text white for better contrast */
    }
    .commit-item a {
      color: #58a6ff; /* Use a brighter blue for links for better contrast */
      text-decoration: none;
    }
    .commit-item a:hover {
      text-decoration: underline;
    }
    #commit-history-section h2 {
        margin-top: 3rem;
        margin-bottom: 1.5rem;
    }
  </style>
</head>
<body>

  <main class="container my-5">
    <h2 class="mb-4">üìã Project VI ‚Äì Group 4 Project Plan</h2>

    <p class="lead">
      This page contains our live project plan for Project VI, shared through Google Sheets.
      It outlines the schedule, assigned tasks, and project milestones. Each group member also maintains their own individual log book.
    </p>

    <div class="ratio ratio-16x9 mb-4">
      <iframe
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRY-b45omQPjsEWErLN6aaPm4vXTtE1JgvOBYg7KqWHkKy0EgLrCyXVV-r_fSwtwgNjlPTugBMfHp_n/pubhtml?widget=true&amp;headers=false"
        title="Project VI Group 4 Google Sheet Project Plan"
        style="border: none;"
        allowfullscreen>
      </iframe>
    </div>

    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
      <a href="https://github.com/users/kyledavid36/projects/4" target="_blank" style="
        display: inline-block;
        padding: 12px 20px;
        background-color: #24292e;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-family: sans-serif;">
        üöÄ View My Project Roadmap on GitHub
      </a>

      <a href="index.html" class="btn btn-primary" style="display: inline-block; padding: 12px 20px;">
        üè† Return to Home Page
      </a>
    </div>

    ---

    <section id="commit-history-section">
        <h2>Recent GitHub Commit History</h2>
        <div id="commit-history">
            <p>Loading commit history...</p>
        </div>
    </section>

  </main>

  <footer class="text-center mt-5 mb-3 text-muted small">
    <p>&copy; 2025 Alan Hosseinpour. All rights reserved.</p>
  </footer>
 
   <script>
    document.addEventListener('DOMContentLoaded', function () {
      const username = 'kyledavid36'; // Your GitHub username
      const repo = 'KA_Project_VI'; // Your GitHub repository name
      const branchName = 'Phase2'; // The specific branch you want to see
      const commitHistoryDiv = document.getElementById('commit-history');

      // Dynamically set the date range for the last 30 days
      const untilDate = new Date(); // today
      const sinceDate = new Date(); // will be modified to 30 days ago
      sinceDate.setDate(untilDate.getDate() - 30);

      // Convert dates to the ISO format required by the GitHub API (e.g., "2025-07-10T16:33:39.000Z")
      const untilDateString = untilDate.toISOString();
      const sinceDateString = sinceDate.toISOString();

      // Update the API URL to include the branch (sha) and dynamic date parameters
      const apiUrl = `https://api.github.com/repos/${username}/${repo}/commits?sha=${branchName}&since=${sinceDateString}&until=${untilDateString}`;

      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            // Provide a more specific error for a branch not found
            if (response.status === 404 || response.status === 422) {
              throw new Error(`Could not find branch '${branchName}' or it has no commits in the last month.`);
            }
            throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.length === 0) {
            commitHistoryDiv.innerHTML = `<p>No recent commits found in the '${branchName}' branch for the last month.</p>`;
            return;
          }
          commitHistoryDiv.innerHTML = ''; // Clear "Loading" message

          data.forEach(commit => {
            const commitDiv = document.createElement('div');
            commitDiv.classList.add('commit-item');

            const sha = commit.sha.substring(0, 7);
            const author = commit.commit.author ? commit.commit.author.name : 'Unknown Author';
            const date = commit.commit.author ? new Date(commit.commit.author.date).toLocaleString() : 'Unknown Date';
            const message = commit.commit.message.split('\n')[0];
            const commitUrl = commit.html_url;

            commitDiv.innerHTML = `
              <p><strong>Commit:</strong> <a href="${commitUrl}" target="_blank">${sha}</a></p>
              <p><strong>Author:</strong> ${author}</p>
              <p><strong>Date:</strong> ${date}</p>
              <p><strong>Message:</strong> ${message}</p>
            `;
            commitHistoryDiv.appendChild(commitDiv);
          });
        })
        .catch(error => {
          console.error('Error fetching commit history:', error);
          commitHistoryDiv.innerHTML = `<p>Error loading commit history: ${error.message}</p>`;
        });
    });
  </script>
</body>
</html>